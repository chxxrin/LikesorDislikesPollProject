{% load static %}

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static 'css/vote.css'%}"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
    <script src="{% static 'js/html2canvas.js' %}"></script>
</head>

<body onload="다음(0,0);">

    <div class="logo">
        <a href="{% url 'start_page' %}">
            <img src="{% static 'images/logo.png' %}" width="230px"; height="80px"; >
        </a>
    </div>
    <form class="container mt-3" action="{% url 'vote' %}" method="get" enctype="multipart/form-data">
        
        <div class="progress" style="height: 20px;">
            <div class="progress-bar" role="progressbar" style="width: calc(100/10*1%); height: 20px" ></div>
        </div>

        <div class=question>
            <!--1번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice1" id="1" value="1" onclick="다음(1,1);">{{ vote.0.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice1" id="2" value="2" onclick="다음(1,2);">{{ vote.0.choice_set.all.1 }}</button>
            </div>
            <input type="hidden" name="choice1" id="choice1" value="">
        </div>

        <div class=question>
            <!--2번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice2" id="3" value="3" onclick="다음(2,3);">{{ vote.1.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice2" id="4" value="4" onclick="다음(2,4);">{{ vote.1.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice2" id="choice2" value="">
        </div>

        <div class=question>
            <!--3번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice3" id="5" value="5" onclick="다음(3,5);">{{ vote.2.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice3" id="6" value="6" onclick="다음(3,6);">{{ vote.2.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice3" id="choice3" value="">
        </div>

        <div class=question>
            <!--4번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice4" id="7" value="7" onclick="다음(4,7);">{{ vote.3.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice4" id="8" value="8" onclick="다음(4,8);">{{ vote.3.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice4" id="choice4" value="">
        </div>

        <div class=question>
            <!--5번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice5" id="9" value="9" onclick="다음(5,9);">{{ vote.4.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice5" id="10" value="10" onclick="다음(5,10);">{{ vote.4.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice5" id="choice5" value="">
        </div>

        <div class=question>
            <!--6번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice6" id="11" value="11" onclick="다음(6,11);">{{ vote.5.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice6" id="12" value="12" onclick="다음(6,12);">{{ vote.5.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice6" id="choice6" value="">
        </div>

        <div class=question>
            <!--7번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice7" id="13" value="13" onclick="다음(7,13);">{{ vote.6.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice7" id="14" value="14" onclick="다음(7,14);">{{ vote.6.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice7" id="choice7" value="">
        </div>

        <div class=question>
            <!--8번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice8" id="15" value="15" onclick="다음(8,15);">{{ vote.7.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice8" id="16" value="16" onclick="다음(8,16);">{{ vote.7.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice8" id="choice8" value="">
        </div>

        <div class=question>
            <!--9번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice9" id="17" value="17" onclick="다음(9,17);">{{ vote.8.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice9" id="18" value="18" onclick="다음(9,18);">{{ vote.8.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice9" id="choice9" value="">
        </div>

        <div class=question>
            <!--10번 질문-->
            <div class="vote">
                <button class="vote_box1" type="button" name="choice10" id="19" value="19" onclick="다음(10,19);">{{ vote.9.choice_set.all.0 }}</button>
                <p id="text_vs">VS</p>
                <button class="vote_box2" type="button" name="choice10" id="20" value="20" onclick="다음(10,20);">{{ vote.9.choice_set.all.1 }}</button>                
            </div>

            <input type="hidden" name="choice10" id="choice10" value="">
            <div class="vote_done">
                <input type="submit" value="결과보러가기" id="submit-btn" style="display:none;"/>               
            </div>
        </div>

    </form>

    <script>
        function 다음(num, choice) {
            if (num < 10){
                document.getElementsByClassName('question')[num].style.display = 'block';
                document.getElementsByClassName('question')[(num + 1) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 2) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 3) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 4) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 5) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 6) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 7) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 8) % 10].style.display = 'none';
                document.getElementsByClassName('question')[(num + 9) % 10].style.display = 'none';
                document.getElementsByClassName('progress-bar')[0].style.width = 'calc(100/9*'+num+'%)';
            }

            //num: 질문번호, choice: 내선택번호
            if (num == 1){ document.getElementById("choice1").value = choice; }
            else if (num == 2){ document.getElementById("choice2").value = choice;}
            else if (num == 3){ document.getElementById("choice3").value = choice;}
            else if (num == 4){ document.getElementById("choice4").value = choice;}
            else if (num == 5){ document.getElementById("choice5").value = choice;}
            else if (num == 6){ document.getElementById("choice6").value = choice;}
            else if (num == 7){ document.getElementById("choice7").value = choice;}
            else if (num == 8){ document.getElementById("choice8").value = choice;}
            else if (num == 9){ document.getElementById("choice9").value = choice;}
            else if (num == 10){ 
                document.getElementById("choice10").value = choice;
                // alert("투표완료")
                document.getElementById("submit-btn").style.display = 'block';
            }
        }

        /////////////////////////////////////////////////
        function setCookie(cName, cValue, cDay) {
            var expire = new Date();
            expire.setDate(expire.getFullYear() + cDay);
            cookies = cName + '=' + escape(cValue) + '; path=/ '; // 한글 깨짐을 막기위해 escape(cValue)를 합니다.
            if (typeof cDay != 'undefined') cookies += ';expires=' + expire.toGMTString() + ';';
            document.cookie = cookies;
        }

        setCookie("isVoted", 'true', 300)
    </script>