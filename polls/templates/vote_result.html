<!--투표 완료 후 주류, 비주류 인간 타입 show-->
{% load static %}
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static 'css/vote_result.css'%}"/>
    <link href="static/css/style.css" type="text/css" rel="stylesheet">  
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
    <script src="{% static 'js/html2canvas.js' %}"></script>
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
</head>

<body style="background-color: black;">
    <div class="logo">
        <a href="{% url 'start_page' %}">
            <img src="{% static 'images/logo3.png' %}" width="240px" ; height="95px"; >
        </a>
    </div>
    
    <!-- myresult 안의 영역이 결과화면 이미지로 변환됨 -->
    <div class="result-box" id="myresult">
        <div class="vote-text">
            나의 결과는...
        </div>
    {% if type_pk == 1 %}
        <div class="character-name">
            개.취.존.중<br>유니콘
        </div>
        <div>
            <img src="{% static 'images/비주류.png' %}" class="result-image">
            <div class="freepik">
                <a href="http://www.freepik.com"  style="font-size: 5px; color:black; text-decoration: none;">Designed by Freepik</a>
            </div>
            <br><br>
            <div class="unique">
                희귀성 : <span class="text-num">10%</span>
            </div>
            <div class="my-choice">
                내가 고른 주류 항목 : <span class="text-num">{{user_type}}/10</span>
            </div>
        </div>

    {% elif type_pk == 2 %}
        <div class="character-name">
            호불호 확실한<br>고슴도치
        </div>
        <div>
            <img src="{% static 'images/조금비주류.png' %}" class="result-image">
            <div class="freepik">
                <a href="http://www.freepik.com"  style="font-size: 5px; color:black; text-decoration: none;">Designed by Freepik</a>
            </div>
            <br><br>
            
            <div class="unique">
                희귀성 : <span class="text-num">40%</span>
            </div>
            <div class="my-choice">
                내가 고른 주류 항목 : <span class="text-num">{{user_type}}/10</span>
            </div>
        </div>

    {% elif type_pk == 3 %}
        <div class="character-name">
            까탈스럽지만 맞춰주는<br>여우
        </div>
        <div>
            <img src="{% static 'images/조금주류.png' %}" class="result-image">
            <div class="freepik">
                <a href="http://www.freepik.com"  style="font-size: 3px; color:black; text-decoration: none;">Designed by Freepik</a>
            </div>
            <br><br>
            
            <div class="unique">
                희귀성 : <span class="text-num">70%</span>
            </div>
            <div class="my-choice">
                내가 고른 주류 항목 : <span class="text-num">{{user_type}}/10</span>
            </div>
        </div>

        {% else %}
        <div class="character-name">
            너가 좋으면 나도 좋아~<br>수달
        </div>
        <div>
            <img src="{% static 'images/주류.png' %}" class="result-image">
            <div class="freepik">
                <a href="http://www.freepik.com" style="font-size: 5px; color:black; text-decoration: none; text-align:right;">Designed by Freepik</a>
            </div>
            <br><br>
            
            <div class="unique">
                희귀성 : <span class="text-num">90%</span>
            </div>
            <div class="my-choice">
                내가 고른 주류 항목 : <span class="text-num">{{user_type}}/10</span>
            </div>
       </div>
    {% endif %}


    </div>

    <div class="my-vote">
        <div class="vote-text">
            나의 취향은?
        </div><br>
    
        <div class="my-vote-items">
            {% for i in final_choice_list %}
            {% if i.powerful %}
            <br><b style="background-color:#faff00;">{{i}}</b><br> <!--주류인 항목이라면 다르게 표시하도록 : 우선은 굵은글씨로 표현되게해놓았음-->
            {% else %}
            <br>{{i}}<br>  <!--주류인 항목 아니라면 다르게 표시하도록 : 우선은 얇은 글씨로 표현되게해놓았음-->
            {% endif %}
            {% endfor %}<br>
        </div>
    </div>
    


    <!-- sns 공유 버튼 -->
    <div class="sns-share-text">
        내 취향 공유하기
    </div>
    <br>
        <div class="sns-share">
            <a id="btnTwitter" class="link-icon twitter" href="javascript:shareTwitter();"><img src="{% static 'images/twitter.png' %}" width="50px"; height="50px"; ></a>
            <a id="btnFacebook" class="link-icon facebook" href="javascript:shareFacebook();"><img src="{% static 'images/facebook.png' %}" width="50px"; height="50px"; ></a>    
            <a id="btnKakao" class="link-icon kakao" href="javascript:shareKakao();"><img src="{% static 'images/kakao.png' %}" width="50px"; height="50px"; ></a>  
            <a class="hover" href='javascript:void(0);' onclick="PrintDiv($('#myresult'));"><img src="{% static 'images/download.png' %}" width="50px"; height="50px"; ></a>
        </div>
    <div class="now-voting">
        ________________________________________________<br><br>
        <a href="{% url 'main_page' %}" style="color: #faff00;">실시간 투표 현황 보러가기</a><br><br>
    </div>



<script>
    function shareTwitter() {
        var sendText = "전국민대결끝판왕"; // 전달할 텍스트
        var sendUrl = "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"; // 전달할 URL
        window.open("https://twitter.com/intent/tweet?text=" + sendText + "&url=" + sendUrl);
    }
    
    
    function shareFacebook() {
        var sendUrl = "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"; // 전달할 URL
        window.open("http://www.facebook.com/sharer/sharer.php?u=" + sendUrl);
    }
    
    
    function shareKakao() {
        try {
        if (Kakao) {
            Kakao.init('0d9af30db343d4e71f650e9ad9067c58');
        };
    } catch(e) {};
     // 카카오링크 버튼 생성
     Kakao.Link.createDefaultButton({
       container: '#btnKakao', // 카카오공유버튼ID
       objectType: 'feed',
       content: {
         title: "전국민대결끝판왕", // 보여질 제목
         description: "논란 종결", // 보여질 설명
         imageUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}", // 콘텐츠 URL
         link: {
            mobileWebUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}",
            webUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"
         }
       }
     });
    }

    function PrintDiv(div){
        div = div[0]
        html2canvas(div).then(function(canvas){
            var myImage = canvas.toDataURL();
            downloadURI(myImage, "전국민대결끝판왕.png") // 저장될 사진명
        });
    }

    function downloadURI(uri, name){
        var link = document.createElement("a")
        link.download = name;
        link.href = uri;
        document.body.appendChild(link);
        link.click();
    }
    
    </script>
</body>
