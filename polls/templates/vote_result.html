<!--투표 완료 후 주류, 비주류 인간 타입 show-->
{% load static %}
<head>
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
    <script src="{% static 'js/html2canvas.js' %}"></script>
</head>

<!-- myresult 안의 영역이 결과화면 이미지로 변환됨 -->
<div id="myresult">
<a href="{% url 'start_page' %}">홈화면으로(로고)</a><br>
{% if type_pk == 1 %}
    <p>주류 항목 {{user_type}}개를 고른 당신은 비주류 인간입니다.</p>
{% elif type_pk == 2 %}
    <p>주류 항목 {{user_type}}개를 고른 당신은 적당히 주류 인간입니다.</p>
{% elif type_pk == 3 %}
    <p>주류 항목 {{user_type}}개를 고른 당신은 주류 인간입니다.</p>
{% else %}
    <p>주류 항목 {{user_type}}개를 고른 당신은 완전 주류 인간입니다.</p>
{% endif %}
______________________________________

<br><br><선택한 항목은 아래와 같습니다><br>
{% for i in final_choice_list %}
    {% if i.powerful %}
    <br><b style="background-color:#faff00;">{{i}}</b><br> <!--주류인 항목이라면 다르게 표시하도록 : 우선은 굵은글씨로 표현되게 해놓았음-->
    {% else %}
    <br>{{i}}<br>  <!--주류인 항목 아니라면 다르게 표시하도록 : 우선은 얇은 글씨로 표현되게 해놓았음-->
    {% endif %}
{% endfor %}<br>
</div> <!-- 여기까지 이미지 변환 -->
<!-- sns 공유 버튼 -->

<a id="btnTwitter" class="link-icon twitter" href="javascript:shareTwitter();">트위터</a>
<a id="btnFacebook" class="link-icon facebook" href="javascript:shareFacebook();">페이스북</a>    
<a id="btnKakao" class="link-icon kakao" href="javascript:shareKakao();">카카오톡</a>     
<a class="hover" href='javascript:void(0);' onclick="PrintDiv($('#myresult'));">이미지로 저장</a>
<br>_______________________________________<br>
<a href="{% url 'main_page' %}">실시간 투표 현황 보러가기</a><br>


<script>
    function shareTwitter() {
        var sendText = "전국민호불호끝판왕"; // 전달할 텍스트
        var sendUrl = "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"; // 전달할 URL
        window.open("https://twitter.com/intent/tweet?text=" + sendText + "&url=" + sendUrl);
    }
    
    
    function shareFacebook() {
        var sendUrl = "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"; // 전달할 URL
        window.open("http://www.facebook.com/sharer/sharer.php?u=" + sendUrl);
    }
    
    
    function shareKakao() {
        try {
        if (Kakao) {
            Kakao.init('0d9af30db343d4e71f650e9ad9067c58');
        };
    } catch(e) {};
     // 카카오링크 버튼 생성
     Kakao.Link.createDefaultButton({
       container: '#btnKakao', // 카카오공유버튼ID
       objectType: 'feed',
       content: {
         title: "전국민호불호끝판왕", // 보여질 제목
         description: "논란 종결", // 보여질 설명
         imageUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}", // 콘텐츠 URL
         link: {
            mobileWebUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}",
            webUrl: "http://127.0.0.1:8000/vote_result/{{type_pk}}/{{user_type}}/{{c1}}/{{c2}}/{{c3}}/{{c4}}/{{c5}}/{{c6}}/{{c7}}/{{c8}}/{{c9}}/{{c10}}"
         }
       }
     });
    }
    
    function PrintDiv(div){
        div = div[0]
        html2canvas(div).then(function(canvas){
            var myImage = canvas.toDataURL();
            downloadURI(myImage, "전국민대결끝판왕.png") // 저장될 사진명
        });
    }

    function downloadURI(uri, name){
        var link = document.createElement("a")
        link.download = name;
        link.href = uri;
        document.body.appendChild(link);
        link.click();
    }
    
    </script>